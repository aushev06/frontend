{"ast":null,"code":"import _regeneratorRuntime from \"C:/Projects/projects/frontend/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Projects/projects/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"C:/Projects/projects/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"C:/Projects/projects/frontend/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Projects\\\\projects\\\\frontend\\\\pages\\\\_app.tsx\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport theme from '../theme';\nimport '../styles/app.scss';\nimport { wrapper } from \"../redux/store\";\nimport { setUser } from \"../redux/user/slice\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectUserState } from \"../redux/user/user.selector\";\nimport { UserApi } from \"../services/api/UserApi\";\nimport { DirectoryApi } from \"../services/api/DirectoryApi\";\nimport { setDirectories } from \"../redux/directory/slice\";\nimport { AlertContext } from '../hooks/useAlert';\nimport { Slide, Snackbar } from \"@material-ui/core\";\nimport MuiAlert from '@material-ui/lab/Alert';\n\nfunction MyApp(_ref) {\n  _s();\n\n  var Component = _ref.Component,\n      pageProps = _ref.pageProps;\n  var dispatch = useDispatch();\n  var user = useSelector(selectUserState);\n  React.useEffect(function () {\n    var _window;\n\n    if ((_window = window) !== null && _window !== void 0 && _window.location.search.includes('token')) {\n      var _window2;\n\n      var splitToken = (_window2 = window) === null || _window2 === void 0 ? void 0 : _window2.location.search.split('=');\n      var token = splitToken[splitToken.length - 1];\n      window.document.cookie = \"auth_token=\".concat(token.replace('%7C', '|'));\n      window.localStorage.setItem('token', token.replace('%7C', '|'));\n      UserApi.getMe().then(function (responseUser) {\n        dispatch(setUser(responseUser));\n      });\n    }\n\n    if (!user && localStorage.getItem('token')) {\n      UserApi.getMe().then(function (responseUser) {\n        dispatch(setUser(responseUser));\n      });\n    }\n\n    var jssStyles = document.querySelector('#jss-server-side');\n\n    if (jssStyles) {\n      jssStyles.parentElement.removeChild(jssStyles);\n    }\n  }, []);\n\n  var _React$useState = React.useState({\n    text: '',\n    status: 'info',\n    opened: false\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      alertInfo = _React$useState2[0],\n      setAlertInfo = _React$useState2[1];\n\n  var openAlert = function openAlert(text) {\n    var status = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n    setAlertInfo({\n      text: text,\n      status: status,\n      opened: true\n    });\n  };\n\n  var closeAlert = function closeAlert() {\n    setAlertInfo(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        opened: false\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(ThemeProvider, {\n      theme: theme,\n      children: [/*#__PURE__*/_jsxDEV(CssBaseline, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(AlertContext.Provider, {\n        value: {\n          alertInfo: alertInfo,\n          openAlert: openAlert,\n          closeAlert: closeAlert\n        },\n        children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n        TransitionComponent: Slide,\n        anchorOrigin: {\n          vertical: 'top',\n          horizontal: 'right'\n        },\n        open: alertInfo.opened,\n        autoHideDuration: 4500,\n        onClose: closeAlert,\n        children: /*#__PURE__*/_jsxDEV(MuiAlert, {\n          severity: alertInfo.status,\n          children: alertInfo.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this)\n      }, Slide.name, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 9\n  }, this);\n}\n\n_s(MyApp, \"lcjs0cPX1IAzxJtHxAioPwkAWI0=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = MyApp;\nMyApp.getInitialProps = wrapper.getInitialAppProps(function (store) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n      var _ctx$req$cookies;\n\n      var Component, ctx, data, token, user;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Component = _ref2.Component, ctx = _ref2.ctx;\n              _context.next = 3;\n              return DirectoryApi.get({\n                categories: true,\n                themes: true\n              });\n\n            case 3:\n              data = _context.sent;\n              store.dispatch(setDirectories(data)); // @ts-ignore\n\n              token = (_ctx$req$cookies = ctx.req.cookies) === null || _ctx$req$cookies === void 0 ? void 0 : _ctx$req$cookies.auth_token;\n\n              if (!token) {\n                _context.next = 11;\n                break;\n              }\n\n              _context.next = 9;\n              return UserApi.getMe(token);\n\n            case 9:\n              user = _context.sent;\n              store.dispatch(setUser(user));\n\n            case 11:\n              _context.t0 = _objectSpread;\n              _context.t1 = _objectSpread;\n              _context.t2 = {};\n\n              if (!Component.getInitialProps) {\n                _context.next = 20;\n                break;\n              }\n\n              _context.next = 17;\n              return Component.getInitialProps(_objectSpread(_objectSpread({}, ctx), {}, {\n                store: store\n              }));\n\n            case 17:\n              _context.t3 = _context.sent;\n              _context.next = 21;\n              break;\n\n            case 20:\n              _context.t3 = {};\n\n            case 21:\n              _context.t4 = _context.t3;\n              _context.t5 = (0, _context.t1)(_context.t2, _context.t4);\n              _context.t6 = {};\n              _context.t7 = {\n                // Some custom thing for all pages\n                pathname: ctx.pathname\n              };\n              _context.t8 = (0, _context.t0)(_context.t5, _context.t6, _context.t7);\n              return _context.abrupt(\"return\", {\n                pageProps: _context.t8\n              });\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n});\nexport default _c2 = wrapper.withRedux(MyApp);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"MyApp\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["C:/Projects/projects/frontend/pages/_app.tsx"],"names":["React","ThemeProvider","CssBaseline","theme","wrapper","setUser","useDispatch","useSelector","selectUserState","UserApi","DirectoryApi","setDirectories","AlertContext","Slide","Snackbar","MuiAlert","MyApp","Component","pageProps","dispatch","user","useEffect","window","location","search","includes","splitToken","split","token","length","document","cookie","replace","localStorage","setItem","getMe","then","responseUser","getItem","jssStyles","querySelector","parentElement","removeChild","useState","text","status","opened","alertInfo","setAlertInfo","openAlert","closeAlert","prev","vertical","horizontal","name","getInitialProps","getInitialAppProps","store","ctx","get","categories","themes","data","req","cookies","auth_token","pathname","withRedux"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {ThemeProvider} from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport theme from '../theme';\r\nimport '../styles/app.scss';\r\nimport {wrapper} from \"../redux/store\";\r\nimport {setUser, userSlice} from \"../redux/user/slice\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectUserState} from \"../redux/user/user.selector\";\r\nimport {getCookie, UserApi} from \"../services/api/UserApi\";\r\nimport {getCategories} from \"../services/api/CategoryApi\";\r\nimport {DirectoryApi} from \"../services/api/DirectoryApi\";\r\nimport {setDirectories} from \"../redux/directory/slice\";\r\nimport {AlertContext, AlertContextProps} from '../hooks/useAlert';\r\nimport {Slide, Snackbar} from \"@material-ui/core\";\r\n\r\nimport MuiAlert, {Color} from '@material-ui/lab/Alert';\r\n\r\nfunction MyApp({Component, pageProps}) {\r\n    const dispatch = useDispatch();\r\n    const user = useSelector(selectUserState)\r\n\r\n    React.useEffect(() => {\r\n        if (window?.location.search.includes('token')) {\r\n            const splitToken = window?.location.search.split('=');\r\n            const token = splitToken[splitToken.length - 1];\r\n            window.document.cookie = `auth_token=${token.replace('%7C', '|')}`;\r\n            window.localStorage.setItem('token', token.replace('%7C', '|'))\r\n            UserApi.getMe().then(responseUser => {\r\n                dispatch(setUser(responseUser))\r\n            });\r\n        }\r\n\r\n        if (!user && localStorage.getItem('token')) {\r\n            UserApi.getMe().then(responseUser => {\r\n                dispatch(setUser(responseUser))\r\n            });\r\n        }\r\n\r\n\r\n        const jssStyles = document.querySelector('#jss-server-side');\r\n        if (jssStyles) {\r\n            jssStyles.parentElement.removeChild(jssStyles);\r\n        }\r\n    }, []);\r\n\r\n    const [alertInfo, setAlertInfo] = React.useState<AlertContextProps['alertInfo']>({\r\n        text: '',\r\n        status: 'info',\r\n        opened: false,\r\n    });\r\n\r\n    const openAlert = (text: React.ReactNode, status: Color = 'info'): void => {\r\n        setAlertInfo({\r\n            text,\r\n            status,\r\n            opened: true,\r\n        });\r\n    };\r\n\r\n    const closeAlert = (): void => {\r\n        setAlertInfo((prev) => ({\r\n            ...prev,\r\n            opened: false,\r\n        }));\r\n    };\r\n\r\n    return (\r\n        <React.Fragment>\r\n            <ThemeProvider theme={theme}>\r\n                <CssBaseline/>\r\n                <AlertContext.Provider value={{alertInfo, openAlert, closeAlert}}>\r\n                    <Component {...pageProps} />\r\n                </AlertContext.Provider>\r\n\r\n                <Snackbar\r\n                    TransitionComponent={Slide}\r\n                    key={Slide.name}\r\n                    anchorOrigin={{vertical: 'top', horizontal: 'right'}}\r\n                    open={alertInfo.opened}\r\n                    autoHideDuration={4500}\r\n                    onClose={closeAlert}\r\n                >\r\n                    <MuiAlert severity={alertInfo.status}>{alertInfo.text}</MuiAlert>\r\n                </Snackbar>\r\n\r\n            </ThemeProvider>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nMyApp.getInitialProps = wrapper.getInitialAppProps(store => async ({Component, ctx}) => {\r\n    const data = await DirectoryApi.get({categories: true, themes: true})\r\n    store.dispatch(setDirectories(data));\r\n\r\n    // @ts-ignore\r\n    const token = ctx.req.cookies?.auth_token\r\n\r\n    if (token) {\r\n        const user = await UserApi.getMe(token);\r\n        store.dispatch(setUser(user));\r\n    }\r\n\r\n    return {\r\n        pageProps: {\r\n            // Call page-level getInitialProps\r\n            // DON'T FORGET TO PROVIDE STORE TO PAGE\r\n            ...(Component.getInitialProps ? await Component.getInitialProps({...ctx, store}) : {}),\r\n            // Some custom thing for all pages\r\n            pathname: ctx.pathname,\r\n        },\r\n    };\r\n\r\n});\r\n\r\nexport default wrapper.withRedux(MyApp);\r\n"]},"metadata":{},"sourceType":"module"}