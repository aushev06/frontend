{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Projects\\\\projects\\\\frontend\\\\pages\\\\_app.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport theme from '../theme';\nimport '../styles/app.scss';\nimport { wrapper } from \"../redux/store\";\nimport { setUser } from \"../redux/user/slice\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { selectUserState } from \"../redux/user/user.selector\";\nimport { UserApi } from \"../services/api/UserApi\";\nimport { DirectoryApi } from \"../services/api/DirectoryApi\";\nimport { setDirectories } from \"../redux/directory/slice\";\nimport { AlertContext } from '../hooks/useAlert';\nimport { Slide, Snackbar } from \"@material-ui/core\";\nimport MuiAlert from '@material-ui/lab/Alert';\n\nfunction MyApp({\n  Component,\n  pageProps\n}) {\n  const dispatch = useDispatch();\n  const user = useSelector(selectUserState);\n  React.useEffect(() => {\n    var _window;\n\n    if ((_window = window) !== null && _window !== void 0 && _window.location.search.includes('token')) {\n      var _window2;\n\n      const splitToken = (_window2 = window) === null || _window2 === void 0 ? void 0 : _window2.location.search.split('=');\n      const token = splitToken[splitToken.length - 1];\n      window.document.cookie = `auth_token=${token.replace('%7C', '|')}`;\n      window.localStorage.setItem('token', token.replace('%7C', '|'));\n      UserApi.getMe().then(responseUser => {\n        dispatch(setUser(responseUser));\n      });\n    }\n\n    if (localStorage.getItem('token')) {\n      UserApi.getMe().then(responseUser => {\n        dispatch(setUser(responseUser));\n      });\n    }\n\n    const jssStyles = document.querySelector('#jss-server-side');\n\n    if (jssStyles) {\n      jssStyles.parentElement.removeChild(jssStyles);\n    }\n  }, []);\n  const [alertInfo, setAlertInfo] = React.useState({\n    text: '',\n    status: 'info',\n    opened: false\n  });\n\n  const openAlert = (text, status = 'info') => {\n    setAlertInfo({\n      text,\n      status,\n      opened: true\n    });\n  };\n\n  const closeAlert = () => {\n    setAlertInfo(prev => _objectSpread(_objectSpread({}, prev), {}, {\n      opened: false\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(ThemeProvider, {\n      theme: theme,\n      children: [/*#__PURE__*/_jsxDEV(CssBaseline, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AlertContext.Provider, {\n        value: {\n          alertInfo,\n          openAlert,\n          closeAlert\n        },\n        children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n        TransitionComponent: Slide,\n        anchorOrigin: {\n          vertical: 'top',\n          horizontal: 'right'\n        },\n        open: alertInfo.opened,\n        autoHideDuration: 4500,\n        onClose: closeAlert,\n        children: /*#__PURE__*/_jsxDEV(MuiAlert, {\n          severity: alertInfo.status,\n          children: alertInfo.text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this)\n      }, Slide.name, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n\nMyApp.getInitialProps = wrapper.getInitialAppProps(store => async ({\n  Component,\n  ctx\n}) => {\n  var _ctx$req$cookies;\n\n  const data = await DirectoryApi.get({\n    categories: true,\n    themes: true\n  });\n  store.dispatch(setDirectories(data));\n  console.log((_ctx$req$cookies = ctx.req.cookies) === null || _ctx$req$cookies === void 0 ? void 0 : _ctx$req$cookies.auth_token);\n  return {\n    pageProps: _objectSpread(_objectSpread({}, Component.getInitialProps ? await Component.getInitialProps(_objectSpread(_objectSpread({}, ctx), {}, {\n      store\n    })) : {}), {}, {\n      // Some custom thing for all pages\n      pathname: ctx.pathname\n    })\n  };\n});\nexport default wrapper.withRedux(MyApp);","map":{"version":3,"sources":["C:/Projects/projects/frontend/pages/_app.tsx"],"names":["React","ThemeProvider","CssBaseline","theme","wrapper","setUser","useDispatch","useSelector","selectUserState","UserApi","DirectoryApi","setDirectories","AlertContext","Slide","Snackbar","MuiAlert","MyApp","Component","pageProps","dispatch","user","useEffect","window","location","search","includes","splitToken","split","token","length","document","cookie","replace","localStorage","setItem","getMe","then","responseUser","getItem","jssStyles","querySelector","parentElement","removeChild","alertInfo","setAlertInfo","useState","text","status","opened","openAlert","closeAlert","prev","vertical","horizontal","name","getInitialProps","getInitialAppProps","store","ctx","data","get","categories","themes","console","log","req","cookies","auth_token","pathname","withRedux"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { ThemeProvider } from '@material-ui/core/styles';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport theme from '../theme';\r\nimport '../styles/app.scss';\r\nimport {wrapper} from \"../redux/store\";\r\nimport {setUser, userSlice} from \"../redux/user/slice\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectUserState} from \"../redux/user/user.selector\";\r\nimport {getCookie, UserApi} from \"../services/api/UserApi\";\r\nimport {getCategories} from \"../services/api/CategoryApi\";\r\nimport {DirectoryApi} from \"../services/api/DirectoryApi\";\r\nimport {setDirectories} from \"../redux/directory/slice\";\r\nimport {AlertContext, AlertContextProps} from '../hooks/useAlert';\r\nimport {Slide, Snackbar} from \"@material-ui/core\";\r\n\r\nimport MuiAlert, {Color} from '@material-ui/lab/Alert';\r\n\r\nfunction MyApp({ Component, pageProps }) {\r\n  const dispatch = useDispatch();\r\n  const user = useSelector(selectUserState)\r\n\r\n  React.useEffect(() => {\r\n    if (window?.location.search.includes('token')) {\r\n      const splitToken = window?.location.search.split('=');\r\n      const token = splitToken[splitToken.length - 1];\r\n      window.document.cookie = `auth_token=${token.replace('%7C', '|')}`;\r\n      window.localStorage.setItem('token', token.replace('%7C', '|'))\r\n      UserApi.getMe().then(responseUser => {\r\n        dispatch(setUser(responseUser))\r\n      });\r\n    }\r\n\r\n    if (localStorage.getItem('token')) {\r\n      UserApi.getMe().then(responseUser => {\r\n        dispatch(setUser(responseUser))\r\n      });\r\n    }\r\n\r\n\r\n    const jssStyles = document.querySelector('#jss-server-side');\r\n    if (jssStyles) {\r\n      jssStyles.parentElement.removeChild(jssStyles);\r\n    }\r\n  }, []);\r\n\r\n  const [alertInfo, setAlertInfo] = React.useState<AlertContextProps['alertInfo']>({\r\n    text: '',\r\n    status: 'info',\r\n    opened: false,\r\n  });\r\n\r\n  const openAlert = (text: React.ReactNode, status: Color = 'info'): void => {\r\n    setAlertInfo({\r\n      text,\r\n      status,\r\n      opened: true,\r\n    });\r\n  };\r\n\r\n  const closeAlert = (): void => {\r\n    setAlertInfo((prev) => ({\r\n      ...prev,\r\n      opened: false,\r\n    }));\r\n  };\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <ThemeProvider theme={theme}>\r\n        <CssBaseline />\r\n        <AlertContext.Provider value={{ alertInfo, openAlert, closeAlert }}>\r\n          <Component {...pageProps} />\r\n        </AlertContext.Provider>\r\n\r\n        <Snackbar\r\n            TransitionComponent={Slide}\r\n            key={Slide.name}\r\n            anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n            open={alertInfo.opened}\r\n            autoHideDuration={4500}\r\n            onClose={closeAlert}\r\n        >\r\n          <MuiAlert severity={alertInfo.status}>{alertInfo.text}</MuiAlert>\r\n        </Snackbar>\r\n\r\n      </ThemeProvider>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nMyApp.getInitialProps = wrapper.getInitialAppProps(store => async ({Component, ctx}) => {\r\n  const data = await DirectoryApi.get({ categories: true, themes: true })\r\n  store.dispatch(setDirectories(data));\r\n\r\n  console.log(ctx.req.cookies?.auth_token)\r\n\r\n  return {\r\n    pageProps: {\r\n      // Call page-level getInitialProps\r\n      // DON'T FORGET TO PROVIDE STORE TO PAGE\r\n      ...(Component.getInitialProps ? await Component.getInitialProps({...ctx, store}) : {}),\r\n      // Some custom thing for all pages\r\n      pathname: ctx.pathname,\r\n    },\r\n  };\r\n\r\n});\r\n\r\nexport default wrapper.withRedux(MyApp);\r\n"]},"metadata":{},"sourceType":"module"}